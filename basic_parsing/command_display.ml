(* Text display of a the commands in the commands catalog *)

let text_display = [
	("FEMTO", "\001");
	("PICO", "\002");
	("NANO", "\003");
	("MICRO", "\004");
	("MILLI", "\005");
	("KILO", "\006");
	("MEGA", "\007");
	("GIGA", "\008");
	("TERA", "\009");
	("PETA", "\010");
	("EXA", "\011");
	("DISP", "\012");
	("EOL", "\013");
	("ASSIGN", "\014");
	("TIMESTENPOWER", "\015");
	("LEQ", "\016");
	("DIFFERENT", "\017");
	("GEQ", "\018");
	("IMPL", "\019");
	("QUOTE", "\034");
	("LPAR", "(");
	("RPAR", ")");
	("COLON", ":");
	("LESS", "<");
	("EQUAL", "=");
	("GREATER", ">");
	("QMARK", "?");
	("LSQBRACKET", "[");
	("RSQBRACKET", "]");
	("LBRACKET", "{");
	("RBRACKET", "}");
	("POLPAR", "Pol(");
	("SIN", "sin ");
	("COS", "cos ");
	("TAN", "tan ");
	("LN", "ln ");
	("SQRT", "\134");
	("UMINUS", "\135");
	("THICKP", "\136");
	("PLUS", "+");
	("POWER2", "\139");
	("COORDSIGN", "\140");
	("INTEGRALPAR", "\230\187(");
	("ARCSIN", "sin\155 ");
	("ARCCOS", "cos\155 ");
	("ARCTAN", "tan\155 ");
	("LOG", "log ");
	("CURT", "\229\223\134");
	("ABS", "Abs ");
	("THICKC", "\152");
	("MINUS", "\153");
	("POWERMINUS1", "\155");
	("DEGREESIGN", "\156");
	("RECPAR", "Rec(");
	("SINH", "sinh ");
	("COSH", "cosh ");
	("TANH", "tanh ");
	("EPOWER", "e\168");
	("INT", "Int ");
	("POWER", "\168");
	("TIMES", "\169");
	("EXCLAMATIONMARK", "\171");
	("RADIANSIGN", "\172");
	("ARCSINH", "sinh\155 ");
	("ARCCOSH", "cosh\155 ");
	("ARCTANH", "tanh\155 ");
	("TENPOWER", "\181");
	("FRAC", "Frac ");
	("NSQRT", "\229\221\134");
	("DIVIDED", "\185");
	("FRACSIGN", "\187");
	("GRADSIGN", "\188");
	("ANS", "Ans");
	("RAN", "Ran\035 ");
	("SMALLR", "\205");
	("THETA", "\206");
	("PI", "\208");
	("CLS", "Cls");
	("RND", "Rnd");
	("NORM", "Norm ");
	("DEG", "Deg");
	("RAD", "Rad");
	("GRA", "Gra");
	("ENG", "Eng");
	("INTG", "Intg ");
	("PLOT", "Plot ");
	("LINE", "Line");
	("LBL", "Lbl ");
	("FIX", "Fix ");
	("SCI", "Sci ");
	("DSZ", "Dsz ");
	("ISZ", "Isz ");
	("FACTOR", "Factor ");
	("VIEWWINDOW", "ViewWindow ");
	("GOTO", "Goto ");
	("PROG", "Prog ");
	("GRAPHYEQ", "Graph Y=");
	("GRAPHS", "Graph \230\187");
	("GRAPHYG", "Graph Y>");
	("GRAPHYL", "Graph Y<");
	("GRAPHYGEQ", "Graph Y\018");
	("GRAPHYLEQ", "Graph Y\016");
	("GRAPHREQ", "Graph r=");
	("GRAPHXYEQ", "Graph(X,Y)=(");
	("PPAR", "P(");
	("QPAR", "Q(");
	("RPAR", "R(");
	("TPAR", "t(");
	("MAX", "Max(");
	("DET", "Det ");
	("ARG", "Arg ");
	("CONJG", "Conjg ");
	("REP", "ReP ");
	("IMP", "ImP ");
	("DOVERDX", "d/dx(");
	("DSQOVERDXSQ", "d\139/dx\139");
	("SOLVE", "Solve(");
	
	(** Above: done
		Below: to do **)
	
	("SIGMAPAR", "\127)");
	("FMIN", "\127*");
	("FMAX", "\127+");
	("SEQ", "\127,");
	("MIN", "\127-");
	("MEAN", "\127.");
	("MEDIAN", "\127/");
	("SOLVEN", "\1270");
	("MOD", "\127:");
	("MODEXP", "\127;");
	("GCD", "\127<");
	("LCM", "\127=");
	("MAT", "\127@");
	("TRN", "\127A");
	("STARROW", "\127B");
	("STARROWPLUS", "\127C");
	("ROWPLUS", "\127D");
	("SWAP", "\127E");
	("DIM", "\127F");
	("FILL", "\127G");
	("IDENTITY", "\127H");
	("AUGMENT", "\127I");
	("LISTTOMAT", "\127J");
	("MATTOLIST", "\127K");
	("SUM", "\127L");
	("PROD", "\127M");
	("PERCENT", "\127N");
	("CUML", "\127O");
	("CPLXI", "\127P");
	("LIST", "\127Q");
	("DELTALIST", "\127R");
	("CHEVRON", "\127T");
	("REF", "\127U");
	("RREF", "\127V");
	("BLACKARROW", "\127W");
	("LOGAB", "\127\133");
	("RNDFIX", "\127\134");
	("RANINT", "\127\135");
	("RANLIST", "\127\136");
	("RANBIN", "\127\137");
	("RANNORM", "\127\138");
	("GETKEY", "\127\143");
	("TOSIMP", "\127\156");
	("AND", "\127\176");
	("OR", "\127\177");
	("NOT", "\127\179");
	("XOR", "\127\180");
	("INTDIV", "\127\188");
	("RMDR", "\127\189");
	("IF", "\247\000");
	("THEN", "\247\001");
	("ELSE", "\247\002");
	("IFEND", "\247\003");
	("FOR", "\247\004");
	("TO", "\247\005");
	("STEP", "\247\006");
	("NEXT", "\247\007");
	("WHILE", "\247\b");
	("WHILEEND", "\247\t");
	("DO", "\247\n");
	("LPWHILE", "\247\011");
	("RETURN", "\247\012");
	("BREAK", "\247\r");
	("STOP", "\247\014");
	("LOCATE", "\247\016");
	("CLRTEXT", "\247\024");
	("CLRGRAPH", "\247\025");
	("CLRLIST", "\247\026");
	("SLNORMAL", "\247\028");
	("SLTHICK", "\247\029");
	("SLBROKEN", "\247\030");
	("SLDOT", "\247\031");
	("DRAWGRAPH", "\247 ");
	("DRAWDYNA", "\247\"");
	("DRAWSTAT", "\247#");
	("NORMALG", "\247+");
	("THICKG", "\247,");
	("BROKENTHICKG", "\247-");
	("BAR", "\247<");
	("DOTG", "\247?");
	("SGPH1", "\247J");
	("SGPH2", "\247K");
	("SGPH3", "\247L");
	("SQUARE", "\247M");
	("CROSS", "\247N");
	("DOT", "\247O");
	("SCATTER", "\247P");
	("XYLINE", "\247Q");
	("HIST", "\247R");
	("MEDBOX", "\247S");
	("NDIST", "\247U");
	("BROKEN", "\247V");
	("SWINDAUTO", "\247`");
	("SWINDMAN", "\247a");
	("GRAPHXEQ", "\247b");
	("YEQUALTYPE", "\247c");
	("REQUALTYPE", "\247d");
	("PARAMTYPE", "\247e");
	("XEQUALTYPE", "\247g");
	("XGTYPE", "\247h");
	("XLTYPE", "\247i");
	("YGTYPE", "\247j");
	("YLTYPE", "\247k");
	("YGEQTYPE", "\247l");
	("YLEQTYPE", "\247m");
	("XGEQTYPE", "\247n");
	("XLEQTYPE", "\247o");
	("GCONNECT", "\247p");
	("GPLOT", "\247q");
	("BGNONE", "\247x");
	("BGPICT", "\247y");
	("GRIDOFF", "\247z");
	("GRIDON", "\247}");
	("DVAR", "\247\128");
	("SKETCHNORMAL", "\247\140");
	("SKETCHTHICK", "\247\141");
	("SKETCHBROKEN", "\247\142");
	("SKETCHDOT", "\247\143");
	("STOPICT", "\247\147");
	("RCLPICT", "\247\148");
	("STOGMEM", "\247\149");
	("RCLGMEM", "\247\150");
	("STOVWIN", "\247\151");
	("RCLVWIN", "\247\152");
	("PERCENTSIGN", "\247\153");
	("DATA", "\247\154");
	("MENU", "\247\158");
	("RCLCAPT", "\247\159");
	("TANGENT", "\247\160");
	("NORMAL", "\247\161");
	("INVERSE", "\247\162");
	("VERTICAL", "\247\163");
	("HORIZONTAL", "\247\164");
	("TEXT", "\247\165");
	("CIRCLE", "\247\166");
	("FLINE", "\247\167");
	("PLOTON", "\247\168");
	("PLOTOFF", "\247\169");
	("PLOTCHG", "\247\170");
	("PXLON", "\247\171");
	("PXLOFF", "\247\172");
	("PXLCHG", "\247\173");
	("PXLTEST", "\247\175");
	("SORTA", "\247\176");
	("SORTD", "\247\177");
	("YDRAWSPEEDNORM", "\247\190");
	("YDRAWSPEEDHIGH", "\247\191");
	("FUNCON", "\247\192");
	("SIMULON", "\247\193");
	("AXESON", "\247\194");
	("COORDON", "\247\195");
	("LABELON", "\247\196");
	("DERIVON", "\247\197");
	("LOCUSON", "\247\198");
	("GSELON", "\247\200");
	("TSELON", "\247\201");
	("DSELON", "\247\202");
	("DRAWON", "\247\204");
	("ABOVERC", "\247\205");
	("DOVERC", "\247\206");
	("FUNCOFF", "\247\208");
	("SIMULOFF", "\247\209");
	("AXESOFF", "\247\210");
	("COORDOFF", "\247\211");
	("LABELOFF", "\247\212");
	("DERIVOFF", "\247\213");
	("LOCUSOFF", "\247\214");
	("GSELOFF", "\247\216");
	("TSELOFF", "\247\217");
	("DSELOFF", "\247\218");
	("DRAWOFF", "\247\220");
	("TODMS", "\249\005");
	("TOAPLUSBI", "\249\006");
	("TORTHETA", "\249\007");
	("REAL", "\249\b");
	("APLUSBI", "\249\t");
	("RTHETA", "\249\n");
	("ENGON", "\249\011");
	("ENGOFF", "\249\012");
	("FN", "\249\027");
	("FILE", "\249\028");
	("CLRMAT", "\249\030");
	("ZOOMAUTO", "\249 ");
	("NONE", "\249(");
	("STICKLENGTH", "\249)");
	("STICKHORIZ", "\249*");
	("GRAPHXG", "\249,");
	("GRAPHXL", "\249-");
	("GRAPHXGEQ", "\249.");
	("GRAPHXLEQ", "\249/");
	("STRJOIN", "\2490");
	("STRLEN", "\2491");
	("STRCMP", "\2492");
	("STRSRC", "\2493");
	("STRLEFT", "\2494");
	("STRRIGHT", "\2495");
	("STRMID", "\2496");
	("EXPSTR", "\2497");
	("EXPPAR", "\2498");
	("STRUPR", "\2499");
	("STRLWR", "\249:");
	("STRINV", "\249;");
	("STRSHIFT", "\249<");
	("STRROTATE", "\249=");
	("STR", "\249?");
];;

(* When s is a string containing special characters,
	returns the list of symbols (in string form) *)
let str_to_rev_symblist (s : string) =
	let n = String.length s in
	let rec aux acc i =
		if i >= n
			then acc
		else if List.mem (Char.code s.[i]) [127;247;249;229;230;231]
			then aux ((String.init 2 (function 0 -> s.[i] | _ -> s.[i+1]))::acc) (i+2)
		else aux ((String.make 1 s.[i])::acc) (i+1)
	in
	aux [] 0;;
	